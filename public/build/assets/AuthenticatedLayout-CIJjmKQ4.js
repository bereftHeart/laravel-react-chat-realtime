import{r as d,j as e,a as y,u as j,W as D,q as L}from"./app-CIwtJv6D.js";import{A as $}from"./ApplicationLogo-BTt0NFx2.js";import{q as _}from"./transition-d_KwjNmP.js";import{U as I}from"./UserAvatar-C-eX5GK5.js";import{k as S}from"./Modal-4BrOGCse.js";import{I as C}from"./InputLabel-D-rkH1Q9.js";import{T as M,I as k}from"./TextInput-KEKR9Rgl.js";import{C as T}from"./Checkbox-CUStd9Dr.js";function A({title:s,titleId:t,...a},r){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?d.createElement("title",{id:t},s):null,d.createElement("path",{d:"M10 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM16.25 5.75a.75.75 0 0 0-1.5 0v2h-2a.75.75 0 0 0 0 1.5h2v2a.75.75 0 0 0 1.5 0v-2h2a.75.75 0 0 0 0-1.5h-2v-2Z"}))}const F=d.forwardRef(A),w=d.createContext(),v=({children:s})=>{const[t,a]=d.useState(!1),r=()=>{a(i=>!i)};return e.jsx(w.Provider,{value:{open:t,setOpen:a,toggleOpen:r},children:e.jsx("div",{className:"relative",children:s})})},R=({children:s})=>{const{open:t,setOpen:a,toggleOpen:r}=d.useContext(w);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:r,children:s}),t&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>a(!1)})]})},O=({align:s="right",width:t="48",contentClasses:a="py-1 bg-white dark:bg-gray-700",children:r})=>{const{open:i,setOpen:l}=d.useContext(w);let u="origin-top";s==="left"?u="ltr:origin-top-left rtl:origin-top-right start-0":s==="right"&&(u="ltr:origin-top-right rtl:origin-top-left end-0");let x="";return t==="48"&&(x="w-48"),e.jsx(e.Fragment,{children:e.jsx(_,{as:d.Fragment,show:i,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:`absolute z-50 mt-2 rounded-md shadow-lg ${u} ${x}`,onClick:()=>l(!1),children:e.jsx("div",{className:"rounded-md ring-1 ring-black ring-opacity-5 "+a,children:r})})})})},q=({className:s="",children:t,...a})=>e.jsx(y,{...a,className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-800 transition duration-150 ease-in-out "+s,children:t});v.Trigger=R;v.Content=O;v.Link=q;const f=v;function B({active:s=!1,className:t="",children:a,...r}){return e.jsx(y,{...r,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium leading-5 transition duration-150 ease-in-out focus:outline-none "+(s?"border-indigo-400 dark:border-indigo-600 text-gray-900 dark:text-gray-100 focus:border-indigo-700 ":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-700 focus:text-gray-700 dark:focus:text-gray-300 focus:border-gray-300 dark:focus:border-gray-700 ")+t,children:a})}function N({active:s=!1,className:t="",children:a,...r}){return e.jsx(y,{...r,className:`w-full flex items-start ps-3 pe-4 py-2 border-l-4 ${s?"border-indigo-400 dark:border-indigo-600 text-indigo-700 dark:text-indigo-300 bg-indigo-50 dark:bg-indigo-900/50 focus:text-indigo-800 dark:focus:text-indigo-200 focus:bg-indigo-100 dark:focus:bg-indigo-900 focus:border-indigo-700 dark:focus:border-indigo-300":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600 focus:text-gray-800 dark:focus:text-gray-200 focus:bg-gray-50 dark:focus:bg-gray-700 focus:border-gray-300 dark:focus:border-gray-600"} text-base font-medium focus:outline-none transition duration-150 ease-in-out ${t}`,children:a})}let b;const P=new Uint8Array(16);function V(){if(!b&&(b=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!b))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return b(P)}const o=[];for(let s=0;s<256;++s)o.push((s+256).toString(16).slice(1));function z(s,t=0){return o[s[t+0]]+o[s[t+1]]+o[s[t+2]]+o[s[t+3]]+"-"+o[s[t+4]]+o[s[t+5]]+"-"+o[s[t+6]]+o[s[t+7]]+"-"+o[s[t+8]]+o[s[t+9]]+"-"+o[s[t+10]]+o[s[t+11]]+o[s[t+12]]+o[s[t+13]]+o[s[t+14]]+o[s[t+15]]}const W=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),U={randomUUID:W};function E(s,t,a){if(U.randomUUID&&!t&&!s)return U.randomUUID();s=s||{};const r=s.random||(s.rng||V)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,z(r)}const Z=({})=>{const[s,t]=d.useState([]),{on:a}=j();return d.useEffect(()=>{a("toast.show",r=>{const i=E();t(l=>[...l,{message:r,uuid:i}]),setTimeout(()=>{t(l=>l.filter(u=>u.uuid!==i))},5e3)})},[a]),e.jsx("div",{className:"toast toast-top toast-end",children:s.map(r=>e.jsx("div",{className:"alert alert-info",children:e.jsx("span",{className:"dark:text-gray-300 text-gray-800 font-semibold",children:r.message})},r.uuid))})},G=Z,H=()=>{const[s,t]=d.useState([]),{on:a}=j();return d.useEffect(()=>{a("newMessageNotification",({message:r,user:i,group_id:l})=>{const u=E();t(x=>[...x,{message:r,user:i,group_id:l,uuid:u}]),setTimeout(()=>{t(x=>x.filter(h=>h.uuid!==u))},5e3)})},[a]),e.jsx("div",{className:"toast toast-top toast-end",children:s.map(r=>e.jsx("div",{className:"alert alert-info",children:e.jsxs(y,{href:r.group_id?route("chat.group",r.group_id):route("chat.user",r.user.id),className:"flex items-center gap-3",children:[e.jsx(I,{user:r.user}),e.jsx("span",{className:"dark:text-gray-200 font-semibold",children:r.message})]})},r.uuid))})},J=H,K=({show:s=!1,onClose:t=()=>{}})=>{const{emit:a}=j(),{data:r,setData:i,processing:l,reset:u,post:x,errors:h}=D({id:"",name:"",is_admin:!1}),p=m=>{m.preventDefault(),x(route("user.store"),{onSuccess:()=>{a("toast.show",`User ${r.name} created successfully`),n()}})},n=()=>{u(),t()};return e.jsx(S,{show:s,onClose:n,children:e.jsxs("form",{onSubmit:p,className:"p-6 overflow-y-auto no-scrollbar",children:[e.jsx("h2",{className:"text-lg font-bold mb-6 text-gray-900 dark:text-gray-100",children:"Create new user"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(C,{htmlFor:"name",value:"Group Name"}),e.jsx(M,{id:"name",className:"my-1 w-full block",value:r.name,onChange:m=>i("name",m.target.value),isFocused:!0,required:!0}),e.jsx(k,{message:h.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(C,{htmlFor:"email",value:"Email"}),e.jsx(M,{id:"email",type:"email",className:"my-1 w-full block",value:r.email||"",onChange:m=>i("email",m.target.value)}),e.jsx(k,{message:h.email})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"flex items-center ",children:[e.jsx(T,{name:"is_admin",checked:r.is_admin,onChange:m=>i("is_admin",m.target.checked)}),e.jsx("span",{className:"ms-2 text-sm text-gray-700 dark:text-gray-300",children:"Make admin"})]}),e.jsx(k,{message:h.is_admin})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{type:"button",onClick:n,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary ml-2",disabled:l,children:"Create"})]})]})})},Q=K;function oe({header:s,children:t}){const a=L(),r=a.props.auth.user,i=a.props.conversations,[l,u]=d.useState(!1),[x,h]=d.useState(!1),{emit:p}=j();return d.useEffect(()=>(i.forEach(n=>{let m=n.is_group?`message.group.${n.id}`:`message.user.${[parseInt(r.id),parseInt(n.id)].sort((c,g)=>c-g).join("-")}`;Echo.private(m).error(c=>{console.log(c)}).listen("SocketMessage",c=>{const g=c.message;p("message.created",g),g.sender_id!==r.id&&p("newMessageNotification",{user:g.sender,group_id:g.group_id,message:g.message||`Shared ${g.attachments.length===1?"an attachment":g.attachments.length+" attachments"}`})}),n.is_group&&Echo.private(`group.deleted.${n.id}`).listen("GroupDeleted",c=>{console.log("group deleted",c),p("group.deleted",{id:c.id,name:c.name})}).error(c=>{console.error(c)})}),()=>{i.forEach(n=>{let m=n.is_group?`message.group.${n.id}`:`message.user.${[parseInt(r.id),parseInt(n.id)].sort((c,g)=>c-g).join("-")}`;Echo.leave(m),n.is_group&&Echo.leave(`group.deleted.${n.id}`)})}),[i]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col h-screen",children:[e.jsxs("nav",{className:"bg-white dark:bg-gray-800 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"shrink-0 flex items-center",children:e.jsx(y,{href:"/",children:e.jsx($,{className:"block h-9 w-auto fill-current text-gray-800 dark:text-gray-200"})})}),e.jsx("div",{className:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex",children:e.jsx(B,{href:route("dashboard"),active:route().current("dashboard"),children:"Dashboard"})})]}),e.jsx("div",{className:"hidden sm:flex sm:items-center sm:ms-6",children:e.jsxs("div",{className:"ms-3 relative flex items-center",children:[r.is_admin&&e.jsxs("button",{className:"btn btn-info text-gray-800 dark:text-gray-200",onClick:()=>h(!0),children:[e.jsx(F,{className:"h-6 w-6 "}),"Add new user"]}),e.jsxs(f,{children:[e.jsx(f.Trigger,{children:e.jsx("span",{className:"inline-flex rounded-md",children:e.jsxs("button",{type:"button",className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 hover:text-gray-700 dark:hover:text-gray-300 focus:outline-none transition ease-in-out duration-150",children:[r.name,e.jsx("svg",{className:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})}),e.jsxs(f.Content,{children:[e.jsx(f.Link,{href:route("profile.edit"),children:"Profile"}),e.jsx(f.Link,{href:route("logout"),method:"post",as:"button",children:"Log Out"})]})]})]})}),e.jsx("div",{className:"-me-2 flex items-center sm:hidden",children:e.jsx("button",{onClick:()=>u(n=>!n),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 dark:text-gray-500 hover:text-gray-500 dark:hover:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-900 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-900 focus:text-gray-500 dark:focus:text-gray-400 transition duration-150 ease-in-out",children:e.jsxs("svg",{className:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("path",{className:l?"hidden":"inline-flex",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"}),e.jsx("path",{className:l?"inline-flex":"hidden",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})]})})})]})}),e.jsxs("div",{className:(l?"block":"hidden")+" sm:hidden",children:[e.jsx("div",{className:"pt-2 pb-3 space-y-1",children:e.jsx(N,{href:route("dashboard"),active:route().current("dashboard"),children:"Dashboard"})}),e.jsxs("div",{className:"pt-4 pb-1 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"px-4",children:[e.jsx("div",{className:"font-medium text-base text-gray-800 dark:text-gray-200",children:r.name}),e.jsx("div",{className:"font-medium text-sm text-gray-500",children:r.email})]}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx(N,{href:route("profile.edit"),children:"Profile"}),e.jsx(N,{method:"post",href:route("logout"),as:"button",children:"Log Out"})]})]})]})]}),s&&e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:s})}),t]}),e.jsx(G,{}),e.jsx(J,{}),e.jsx(Q,{show:x,onClose:n=>h(!1)})]})}export{oe as A};
